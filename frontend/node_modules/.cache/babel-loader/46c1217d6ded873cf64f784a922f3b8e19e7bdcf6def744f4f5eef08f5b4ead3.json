{"ast":null,"code":"/**\n * SharePoint Configuration Component\n *\n * A comprehensive component for configuring SharePoint integration using Microsoft Graph API.\n * Combines credential management and SharePoint browsing capabilities.\n *\n * @component\n */import React,{useState,useCallback}from'react';import{Box,Button,Card,CardContent,Collapse,Divider,Grid,Paper,Tab,Tabs,Typography,Alert,AlertTitle}from'@mui/material';import{Check as CheckIcon,CloudDone as CloudDoneIcon,Settings as SettingsIcon,Web as WebIcon,Article as LibraryIcon,Folder as FolderIcon,Description as FileIcon}from'@mui/icons-material';// Import subcomponents\nimport SharePointCredentialManager from\"./sharepoint/SharePointCredentialManager\";import SharePointBrowser from\"./sharepoint/SharePointBrowser\";/**\n * SharePoint Configuration Component\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SharePointConfiguration=_ref=>{let{value={},onChange=()=>{},readOnly=false}=_ref;// Component state\nconst[credentials,setCredentials]=useState(value.credentials||{});const[selectedSite,setSelectedSite]=useState(value.site||null);const[selectedLibrary,setSelectedLibrary]=useState(value.library||null);const[selectedFolder,setSelectedFolder]=useState(value.folder||null);const[selectedFile,setSelectedFile]=useState(value.file||null);// UI state\nconst[activeTab,setActiveTab]=useState(0);const[testResults,setTestResults]=useState(null);const[testing,setTesting]=useState(false);const[error,setError]=useState(null);const[showAdvanced,setShowAdvanced]=useState(false);/**\n   * Handle credentials change\n   */const handleCredentialsChange=useCallback(newCredentials=>{setCredentials(newCredentials);onChange({...value,credentials:newCredentials,site:selectedSite,library:selectedLibrary,folder:selectedFolder,file:selectedFile});},[onChange,selectedFile,selectedFolder,selectedLibrary,selectedSite,value]);/**\n   * Test credentials using Microsoft Graph API\n   */const testCredentials=useCallback(async()=>{setTesting(true);setTestResults(null);setError(null);try{console.log('Testing SharePoint credentials:',credentials);// In a real production environment, we would use a backend API endpoint\n// that securely handles Microsoft Graph API authentication and requests.\n// The frontend would just call an API like `/api/sharepoint/test-credentials`\n// This simulates what our backend API would do with the Microsoft Graph API:\nconst testCredentialsWithGraphAPI=async creds=>{var _tokenResponse$scope,_graphResponse$value$;// Step 1: Get access token for the tenant\nconst getAccessToken=async()=>{// In production: This would be a secure API call that gets a token\n// The token acquisition would happen server-side for security\nreturn new Promise((resolve,reject)=>{setTimeout(()=>{// Validate credentials based on the auth method\nif(creds.authMethod==='oauth'){if(!creds.tenantId||!creds.clientId||!creds.clientSecret){reject(new Error('Missing required OAuth credentials'));return;}// Simulate successful OAuth token acquisition\nresolve({access_token:`mock_${creds.clientId}_token`,token_type:'Bearer',expires_in:3600,ext_expires_in:3600,scope:'Sites.Read.All'});}else if(creds.authMethod==='app'){if(!creds.tenantId||!creds.appId||!creds.appSecret){reject(new Error('Missing required App credentials'));return;}// Simulate successful app-only token acquisition\nresolve({access_token:`mock_${creds.appId}_token`,token_type:'Bearer',expires_in:3600,ext_expires_in:3600});}else if(creds.authMethod==='certificate'){if(!creds.tenantId||!creds.clientId||!creds.certificateThumbprint||!creds.certificatePrivateKey){reject(new Error('Missing required certificate credentials'));return;}// Simulate successful certificate-based token acquisition\nresolve({access_token:`mock_${creds.clientId}_cert_token`,token_type:'Bearer',expires_in:3600,ext_expires_in:3600});}else{reject(new Error('Invalid authentication method'));}},600);});};// Step 2: Make a test API call to Microsoft Graph with the token\nconst testGraphAPI=async token=>{// In production: This would be a real fetch call to Microsoft Graph API\n// GET /sites?search=* or GET /me/followedSites\nreturn new Promise((resolve,reject)=>{setTimeout(()=>{// Simulate a successful Graph API response with data\nresolve({// This follows the Microsoft Graph API response format\nvalue:[{id:\"sample-site-1\",displayName:\"Test Connection Site\",webUrl:`https://${creds.tenantId.replace('.onmicrosoft.com','')}.sharepoint.com/sites/test`,siteCollection:{hostname:`${creds.tenantId.replace('.onmicrosoft.com','')}.sharepoint.com`}}],// Include permission scopes we have access to\n\"@odata.context\":\"https://graph.microsoft.com/v1.0/$metadata#sites\"});},500);});};// Step 3: Execute full test sequence\n// a) Get token\nconst tokenResponse=await getAccessToken();// b) Test token with Graph API call\nconst graphResponse=await testGraphAPI(tokenResponse.access_token);// c) Return full test results\nreturn{status:'success',message:`Successfully connected to SharePoint using ${creds.authMethod==='oauth'?'OAuth':creds.authMethod==='app'?'App-only authentication':'certificate-based authentication'}`,details:{tenant:creds.tenantId,...(creds.authMethod==='oauth'?{clientId:creds.clientId,scope:'Sites.Read.All'}:creds.authMethod==='app'?{appId:creds.appId}:{clientId:creds.clientId,thumbprint:creds.certificateThumbprint}),resource:creds.resourceUrl||'https://graph.microsoft.com',// Include token expiration and scope information\ntoken:{type:tokenResponse.token_type,expires_in:tokenResponse.expires_in,scopes:((_tokenResponse$scope=tokenResponse.scope)===null||_tokenResponse$scope===void 0?void 0:_tokenResponse$scope.split(' '))||['Sites.Read.All']},// Include sample API response\napiTest:{endpoint:'/sites',sitesFound:graphResponse.value.length,firstSite:((_graphResponse$value$=graphResponse.value[0])===null||_graphResponse$value$===void 0?void 0:_graphResponse$value$.displayName)||'No sites found'}}};};// Execute the test\ntry{const result=await testCredentialsWithGraphAPI(credentials);setTestResults(result);}catch(testError){setTestResults({status:'error',message:testError.message||'Failed to authenticate with Microsoft Graph API',details:{error:testError.message,credentials:{authMethod:credentials.authMethod,tenantId:credentials.tenantId,// Don't include secrets in error reports\nhasClientId:!!credentials.clientId,hasClientSecret:!!credentials.clientSecret,hasAppId:!!credentials.appId,hasAppSecret:!!credentials.appSecret,hasCertThumbprint:!!credentials.certificateThumbprint}}});}}catch(err){console.error('Error testing credentials:',err);setError(err.message||'An error occurred while testing credentials');setTestResults({status:'error',message:err.message||'Unknown error'});}finally{setTesting(false);}},[credentials]);/**\n   * Handle site selection\n   */const handleSiteSelect=useCallback(site=>{setSelectedSite(site);setSelectedLibrary(null);setSelectedFolder(null);setSelectedFile(null);onChange({...value,credentials,site,library:null,folder:null,file:null});},[credentials,onChange,value]);/**\n   * Handle library selection\n   */const handleLibrarySelect=useCallback(library=>{setSelectedLibrary(library);setSelectedFolder(null);setSelectedFile(null);onChange({...value,credentials,site:selectedSite,library,folder:null,file:null});},[credentials,onChange,selectedSite,value]);/**\n   * Handle folder selection\n   */const handleFolderSelect=useCallback(folder=>{setSelectedFolder(folder);setSelectedFile(null);onChange({...value,credentials,site:selectedSite,library:selectedLibrary,folder,file:null});},[credentials,onChange,selectedLibrary,selectedSite,value]);/**\n   * Handle file selection\n   */const handleFileSelect=useCallback(file=>{setSelectedFile(file);onChange({...value,credentials,site:selectedSite,library:selectedLibrary,folder:selectedFolder,file});},[credentials,onChange,selectedFolder,selectedLibrary,selectedSite,value]);// Determine if we have valid credentials for browser\nconst hasValidCredentials=Boolean(credentials&&credentials.tenantId&&(credentials.authMethod==='oauth'&&credentials.clientId&&credentials.clientSecret||credentials.authMethod==='app'&&credentials.appId&&credentials.appSecret||credentials.authMethod==='certificate'&&credentials.clientId&&credentials.certificateThumbprint));// Check if a site is selected\nconst hasSiteSelected=Boolean(selectedSite);// Check if a library is selected\nconst hasLibrarySelected=Boolean(selectedLibrary);// Check if a folder is selected\nconst hasFolderSelected=Boolean(selectedFolder);// Check if a file is selected\nconst hasFileSelected=Boolean(selectedFile);return/*#__PURE__*/_jsx(Card,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(CardContent,{sx:{p:2},children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",gutterBottom:true,sx:{mb:2,display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(WebIcon,{sx:{mr:1}}),\"SharePoint Configuration\"]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",paragraph:true,children:\"Configure SharePoint integration using Microsoft Graph API for accessing sites, document libraries, and files.\"}),/*#__PURE__*/_jsxs(Tabs,{value:activeTab,onChange:(e,newValue)=>setActiveTab(newValue),sx:{borderBottom:1,borderColor:'divider',mb:2},children:[/*#__PURE__*/_jsx(Tab,{label:\"Credentials\"}),/*#__PURE__*/_jsx(Tab,{label:\"Browse\",disabled:!hasValidCredentials||readOnly}),/*#__PURE__*/_jsx(Tab,{label:\"Selection\",disabled:!hasFileSelected&&!hasFolderSelected&&!hasLibrarySelected&&!hasSiteSelected})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:activeTab===0?'block':'none',mt:2},children:[/*#__PURE__*/_jsx(SharePointCredentialManager,{credentials:credentials,onChange:handleCredentialsChange,onTest:testCredentials,testResults:testResults,loading:testing,disabled:readOnly}),/*#__PURE__*/_jsx(Button,{sx:{mt:2},variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(SettingsIcon,{}),onClick:()=>setShowAdvanced(!showAdvanced),children:showAdvanced?'Hide Advanced Options':'Show Advanced Options'}),/*#__PURE__*/_jsx(Collapse,{in:showAdvanced,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2,mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Advanced Configuration\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Alert,{severity:\"info\",children:[/*#__PURE__*/_jsx(AlertTitle,{children:\"Microsoft Graph API Usage\"}),\"This component uses the Microsoft Graph API instead of the legacy SharePoint REST API, providing better performance, more capabilities, and improved security. Make sure your app registration has the appropriate permissions.\"]})})})]})})]}),/*#__PURE__*/_jsx(Box,{sx:{display:activeTab===1?'block':'none',mt:2},children:hasValidCredentials?/*#__PURE__*/_jsx(Box,{sx:{height:500},children:/*#__PURE__*/_jsx(SharePointBrowser,{credentials:credentials,onSelectSite:handleSiteSelect,onSelectLibrary:handleLibrarySelect,onSelectFolder:handleFolderSelect,onSelectFile:handleFileSelect,readOnly:readOnly,selectedSite:(selectedSite===null||selectedSite===void 0?void 0:selectedSite.id)||'',selectedLibrary:(selectedLibrary===null||selectedLibrary===void 0?void 0:selectedLibrary.id)||'',selectedFolder:(selectedFolder===null||selectedFolder===void 0?void 0:selectedFolder.id)||''})}):/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",children:[/*#__PURE__*/_jsx(AlertTitle,{children:\"Credentials Required\"}),\"Please configure valid SharePoint credentials in the Credentials tab before browsing.\"]})}),/*#__PURE__*/_jsxs(Box,{sx:{display:activeTab===2?'block':'none',mt:2},children:[/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Selected Items\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[selectedSite&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(WebIcon,{color:\"primary\",sx:{mr:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",fontWeight:\"medium\",children:[\"Site: \",selectedSite.name]})]}),selectedSite.description&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1},children:selectedSite.description}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",sx:{mt:1},children:[\"URL: \",selectedSite.webUrl||selectedSite.url]})]})}),selectedLibrary&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(LibraryIcon,{color:\"primary\",sx:{mr:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",fontWeight:\"medium\",children:[\"Library: \",selectedLibrary.name]})]}),selectedLibrary.description&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mt:1},children:selectedLibrary.description}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",sx:{mt:1},children:[\"Items: \",selectedLibrary.itemCount||0]})]})}),selectedFolder&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(FolderIcon,{color:\"primary\",sx:{mr:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",fontWeight:\"medium\",children:[\"Folder: \",selectedFolder.name]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",sx:{mt:1},children:[\"Path: \",selectedFolder.webUrl]})]})}),selectedFile&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(FileIcon,{color:\"primary\",sx:{mr:1}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",fontWeight:\"medium\",children:[\"File: \",selectedFile.name]})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Type: \",selectedFile.contentType||'Unknown']}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:0.5},children:[\"Size: \",formatFileSize(selectedFile.size||0)]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",display:\"block\",sx:{mt:1},children:[\"URL: \",selectedFile.webUrl]})]})}),!selectedSite&&!selectedLibrary&&!selectedFolder&&!selectedFile&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"No items selected. Please browse and select SharePoint items.\"})})]})]}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2,display:'flex',justifyContent:'flex-end'},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:()=>{setSelectedSite(null);setSelectedLibrary(null);setSelectedFolder(null);setSelectedFile(null);onChange({...value,credentials,site:null,library:null,folder:null,file:null});},sx:{mr:1},children:\"Clear Selection\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",startIcon:/*#__PURE__*/_jsx(CloudDoneIcon,{}),disabled:!hasValidCredentials||!hasFileSelected&&!hasFolderSelected&&!hasLibrarySelected&&!hasSiteSelected,onClick:()=>{// In a real application, this might save the configuration or proceed to the next step\nconsole.log('SharePoint configuration completed:',{credentials,site:selectedSite,library:selectedLibrary,folder:selectedFolder,file:selectedFile});},children:\"Confirm Selection\"})]})]})]})});};/**\n * Format file size to human-readable format\n * @param {number} bytes - File size in bytes\n * @returns {string} Formatted size\n */const formatFileSize=bytes=>{if(bytes===0)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB','TB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i];};export default SharePointConfiguration;","map":{"version":3,"names":["React","useState","useCallback","Box","Button","Card","CardContent","Collapse","Divider","Grid","Paper","Tab","Tabs","Typography","Alert","AlertTitle","Check","CheckIcon","CloudDone","CloudDoneIcon","Settings","SettingsIcon","Web","WebIcon","Article","LibraryIcon","Folder","FolderIcon","Description","FileIcon","SharePointCredentialManager","SharePointBrowser","jsx","_jsx","jsxs","_jsxs","SharePointConfiguration","_ref","value","onChange","readOnly","credentials","setCredentials","selectedSite","setSelectedSite","site","selectedLibrary","setSelectedLibrary","library","selectedFolder","setSelectedFolder","folder","selectedFile","setSelectedFile","file","activeTab","setActiveTab","testResults","setTestResults","testing","setTesting","error","setError","showAdvanced","setShowAdvanced","handleCredentialsChange","newCredentials","testCredentials","console","log","testCredentialsWithGraphAPI","creds","_tokenResponse$scope","_graphResponse$value$","getAccessToken","Promise","resolve","reject","setTimeout","authMethod","tenantId","clientId","clientSecret","Error","access_token","token_type","expires_in","ext_expires_in","scope","appId","appSecret","certificateThumbprint","certificatePrivateKey","testGraphAPI","token","id","displayName","webUrl","replace","siteCollection","hostname","tokenResponse","graphResponse","status","message","details","tenant","thumbprint","resource","resourceUrl","type","scopes","split","apiTest","endpoint","sitesFound","length","firstSite","result","testError","hasClientId","hasClientSecret","hasAppId","hasAppSecret","hasCertThumbprint","err","handleSiteSelect","handleLibrarySelect","handleFolderSelect","handleFileSelect","hasValidCredentials","Boolean","hasSiteSelected","hasLibrarySelected","hasFolderSelected","hasFileSelected","variant","children","sx","p","gutterBottom","mb","display","alignItems","mr","color","paragraph","e","newValue","borderBottom","borderColor","label","disabled","mt","onTest","loading","startIcon","onClick","in","container","spacing","item","xs","severity","height","onSelectSite","onSelectLibrary","onSelectFolder","onSelectFile","fontWeight","name","description","url","itemCount","contentType","formatFileSize","size","justifyContent","bytes","k","sizes","i","Math","floor","parseFloat","pow","toFixed"],"sources":["/home/ai-dev/Desktop/tap-integration-platform/frontend/src/components/integration/SharePointConfiguration.jsx"],"sourcesContent":["/**\n * SharePoint Configuration Component\n *\n * A comprehensive component for configuring SharePoint integration using Microsoft Graph API.\n * Combines credential management and SharePoint browsing capabilities.\n *\n * @component\n */\n\nimport React, { useState, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  Box,\n  Button,\n  Card,\n  CardContent,\n  Collapse,\n  Divider,\n  Grid,\n  Paper,\n  Tab,\n  Tabs,\n  Typography,\n  Alert,\n  AlertTitle,\n} from '@mui/material';\nimport {\n  Check as CheckIcon,\n  CloudDone as CloudDoneIcon,\n  Settings as SettingsIcon,\n  Web as WebIcon,\n  Article as LibraryIcon,\n  Folder as FolderIcon,\n  Description as FileIcon,\n} from '@mui/icons-material';\n\n// Import subcomponents\nimport SharePointCredentialManager from './sharepoint/SharePointCredentialManager';\nimport SharePointBrowser from './sharepoint/SharePointBrowser';\n\n/**\n * SharePoint Configuration Component\n */\nconst SharePointConfiguration = ({\n  value = {},\n  onChange = () => {},\n  readOnly = false,\n}) => {\n  // Component state\n  const [credentials, setCredentials] = useState(value.credentials || {});\n  const [selectedSite, setSelectedSite] = useState(value.site || null);\n  const [selectedLibrary, setSelectedLibrary] = useState(value.library || null);\n  const [selectedFolder, setSelectedFolder] = useState(value.folder || null);\n  const [selectedFile, setSelectedFile] = useState(value.file || null);\n  \n  // UI state\n  const [activeTab, setActiveTab] = useState(0);\n  const [testResults, setTestResults] = useState(null);\n  const [testing, setTesting] = useState(false);\n  const [error, setError] = useState(null);\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  \n  /**\n   * Handle credentials change\n   */\n  const handleCredentialsChange = useCallback((newCredentials) => {\n    setCredentials(newCredentials);\n    \n    onChange({\n      ...value,\n      credentials: newCredentials,\n      site: selectedSite,\n      library: selectedLibrary,\n      folder: selectedFolder,\n      file: selectedFile,\n    });\n  }, [onChange, selectedFile, selectedFolder, selectedLibrary, selectedSite, value]);\n  \n  /**\n   * Test credentials using Microsoft Graph API\n   */\n  const testCredentials = useCallback(async () => {\n    setTesting(true);\n    setTestResults(null);\n    setError(null);\n    \n    try {\n      console.log('Testing SharePoint credentials:', credentials);\n      \n      // In a real production environment, we would use a backend API endpoint\n      // that securely handles Microsoft Graph API authentication and requests.\n      // The frontend would just call an API like `/api/sharepoint/test-credentials`\n      \n      // This simulates what our backend API would do with the Microsoft Graph API:\n      const testCredentialsWithGraphAPI = async (creds) => {\n        // Step 1: Get access token for the tenant\n        const getAccessToken = async () => {\n          // In production: This would be a secure API call that gets a token\n          // The token acquisition would happen server-side for security\n          return new Promise((resolve, reject) => {\n            setTimeout(() => {\n              // Validate credentials based on the auth method\n              if (creds.authMethod === 'oauth') {\n                if (!creds.tenantId || !creds.clientId || !creds.clientSecret) {\n                  reject(new Error('Missing required OAuth credentials'));\n                  return;\n                }\n                \n                // Simulate successful OAuth token acquisition\n                resolve({\n                  access_token: `mock_${creds.clientId}_token`,\n                  token_type: 'Bearer',\n                  expires_in: 3600,\n                  ext_expires_in: 3600,\n                  scope: 'Sites.Read.All'\n                });\n              } \n              else if (creds.authMethod === 'app') {\n                if (!creds.tenantId || !creds.appId || !creds.appSecret) {\n                  reject(new Error('Missing required App credentials'));\n                  return;\n                }\n                \n                // Simulate successful app-only token acquisition\n                resolve({\n                  access_token: `mock_${creds.appId}_token`,\n                  token_type: 'Bearer',\n                  expires_in: 3600,\n                  ext_expires_in: 3600\n                });\n              } \n              else if (creds.authMethod === 'certificate') {\n                if (!creds.tenantId || !creds.clientId || !creds.certificateThumbprint || !creds.certificatePrivateKey) {\n                  reject(new Error('Missing required certificate credentials'));\n                  return;\n                }\n                \n                // Simulate successful certificate-based token acquisition\n                resolve({\n                  access_token: `mock_${creds.clientId}_cert_token`,\n                  token_type: 'Bearer',\n                  expires_in: 3600,\n                  ext_expires_in: 3600\n                });\n              }\n              else {\n                reject(new Error('Invalid authentication method'));\n              }\n            }, 600);\n          });\n        };\n        \n        // Step 2: Make a test API call to Microsoft Graph with the token\n        const testGraphAPI = async (token) => {\n          // In production: This would be a real fetch call to Microsoft Graph API\n          // GET /sites?search=* or GET /me/followedSites\n          return new Promise((resolve, reject) => {\n            setTimeout(() => {\n              // Simulate a successful Graph API response with data\n              resolve({\n                // This follows the Microsoft Graph API response format\n                value: [\n                  {\n                    id: \"sample-site-1\",\n                    displayName: \"Test Connection Site\",\n                    webUrl: `https://${creds.tenantId.replace('.onmicrosoft.com', '')}.sharepoint.com/sites/test`,\n                    siteCollection: {\n                      hostname: `${creds.tenantId.replace('.onmicrosoft.com', '')}.sharepoint.com`\n                    }\n                  }\n                ],\n                // Include permission scopes we have access to\n                \"@odata.context\": \"https://graph.microsoft.com/v1.0/$metadata#sites\",\n              });\n            }, 500);\n          });\n        };\n        \n        // Step 3: Execute full test sequence\n        // a) Get token\n        const tokenResponse = await getAccessToken();\n        \n        // b) Test token with Graph API call\n        const graphResponse = await testGraphAPI(tokenResponse.access_token);\n        \n        // c) Return full test results\n        return {\n          status: 'success',\n          message: `Successfully connected to SharePoint using ${creds.authMethod === 'oauth' ? 'OAuth' : creds.authMethod === 'app' ? 'App-only authentication' : 'certificate-based authentication'}`,\n          details: {\n            tenant: creds.tenantId,\n            ...(creds.authMethod === 'oauth' ? {\n              clientId: creds.clientId,\n              scope: 'Sites.Read.All',\n            } : creds.authMethod === 'app' ? {\n              appId: creds.appId,\n            } : {\n              clientId: creds.clientId,\n              thumbprint: creds.certificateThumbprint,\n            }),\n            resource: creds.resourceUrl || 'https://graph.microsoft.com',\n            // Include token expiration and scope information\n            token: {\n              type: tokenResponse.token_type,\n              expires_in: tokenResponse.expires_in,\n              scopes: tokenResponse.scope?.split(' ') || ['Sites.Read.All'],\n            },\n            // Include sample API response\n            apiTest: {\n              endpoint: '/sites',\n              sitesFound: graphResponse.value.length,\n              firstSite: graphResponse.value[0]?.displayName || 'No sites found'\n            }\n          }\n        };\n      };\n      \n      // Execute the test\n      try {\n        const result = await testCredentialsWithGraphAPI(credentials);\n        setTestResults(result);\n      } catch (testError) {\n        setTestResults({\n          status: 'error',\n          message: testError.message || 'Failed to authenticate with Microsoft Graph API',\n          details: {\n            error: testError.message,\n            credentials: {\n              authMethod: credentials.authMethod,\n              tenantId: credentials.tenantId,\n              // Don't include secrets in error reports\n              hasClientId: !!credentials.clientId,\n              hasClientSecret: !!credentials.clientSecret,\n              hasAppId: !!credentials.appId,\n              hasAppSecret: !!credentials.appSecret,\n              hasCertThumbprint: !!credentials.certificateThumbprint,\n            }\n          }\n        });\n      }\n    } catch (err) {\n      console.error('Error testing credentials:', err);\n      setError(err.message || 'An error occurred while testing credentials');\n      setTestResults({ status: 'error', message: err.message || 'Unknown error' });\n    } finally {\n      setTesting(false);\n    }\n  }, [credentials]);\n  \n  /**\n   * Handle site selection\n   */\n  const handleSiteSelect = useCallback((site) => {\n    setSelectedSite(site);\n    setSelectedLibrary(null);\n    setSelectedFolder(null);\n    setSelectedFile(null);\n    \n    onChange({\n      ...value,\n      credentials,\n      site,\n      library: null,\n      folder: null,\n      file: null,\n    });\n  }, [credentials, onChange, value]);\n  \n  /**\n   * Handle library selection\n   */\n  const handleLibrarySelect = useCallback((library) => {\n    setSelectedLibrary(library);\n    setSelectedFolder(null);\n    setSelectedFile(null);\n    \n    onChange({\n      ...value,\n      credentials,\n      site: selectedSite,\n      library,\n      folder: null,\n      file: null,\n    });\n  }, [credentials, onChange, selectedSite, value]);\n  \n  /**\n   * Handle folder selection\n   */\n  const handleFolderSelect = useCallback((folder) => {\n    setSelectedFolder(folder);\n    setSelectedFile(null);\n    \n    onChange({\n      ...value,\n      credentials,\n      site: selectedSite,\n      library: selectedLibrary,\n      folder,\n      file: null,\n    });\n  }, [credentials, onChange, selectedLibrary, selectedSite, value]);\n  \n  /**\n   * Handle file selection\n   */\n  const handleFileSelect = useCallback((file) => {\n    setSelectedFile(file);\n    \n    onChange({\n      ...value,\n      credentials,\n      site: selectedSite,\n      library: selectedLibrary,\n      folder: selectedFolder,\n      file,\n    });\n  }, [credentials, onChange, selectedFolder, selectedLibrary, selectedSite, value]);\n  \n  // Determine if we have valid credentials for browser\n  const hasValidCredentials = Boolean(\n    credentials && credentials.tenantId && (\n      (credentials.authMethod === 'oauth' && credentials.clientId && credentials.clientSecret) ||\n      (credentials.authMethod === 'app' && credentials.appId && credentials.appSecret) ||\n      (credentials.authMethod === 'certificate' && credentials.clientId && credentials.certificateThumbprint)\n    )\n  );\n  \n  // Check if a site is selected\n  const hasSiteSelected = Boolean(selectedSite);\n  \n  // Check if a library is selected\n  const hasLibrarySelected = Boolean(selectedLibrary);\n  \n  // Check if a folder is selected\n  const hasFolderSelected = Boolean(selectedFolder);\n  \n  // Check if a file is selected\n  const hasFileSelected = Boolean(selectedFile);\n  \n  return (\n    <Card variant=\"outlined\">\n      <CardContent sx={{ p: 2 }}>\n        <Typography variant=\"h5\" gutterBottom sx={{ mb: 2, display: 'flex', alignItems: 'center' }}>\n          <WebIcon sx={{ mr: 1 }} /> \n          SharePoint Configuration\n        </Typography>\n        \n        <Typography variant=\"body2\" color=\"text.secondary\" paragraph>\n          Configure SharePoint integration using Microsoft Graph API for accessing sites, document libraries, and files.\n        </Typography>\n        \n        <Tabs \n          value={activeTab} \n          onChange={(e, newValue) => setActiveTab(newValue)}\n          sx={{ borderBottom: 1, borderColor: 'divider', mb: 2 }}\n        >\n          <Tab label=\"Credentials\" />\n          <Tab \n            label=\"Browse\" \n            disabled={!hasValidCredentials || readOnly}\n          />\n          <Tab \n            label=\"Selection\" \n            disabled={!hasFileSelected && !hasFolderSelected && !hasLibrarySelected && !hasSiteSelected}\n          />\n        </Tabs>\n        \n        {/* Credentials Tab */}\n        <Box sx={{ display: activeTab === 0 ? 'block' : 'none', mt: 2 }}>\n          <SharePointCredentialManager\n            credentials={credentials}\n            onChange={handleCredentialsChange}\n            onTest={testCredentials}\n            testResults={testResults}\n            loading={testing}\n            disabled={readOnly}\n          />\n          \n          <Button\n            sx={{ mt: 2 }}\n            variant=\"outlined\"\n            startIcon={<SettingsIcon />}\n            onClick={() => setShowAdvanced(!showAdvanced)}\n          >\n            {showAdvanced ? 'Hide Advanced Options' : 'Show Advanced Options'}\n          </Button>\n          \n          <Collapse in={showAdvanced}>\n            <Paper variant=\"outlined\" sx={{ p: 2, mt: 2 }}>\n              <Typography variant=\"h6\" gutterBottom>Advanced Configuration</Typography>\n              \n              <Grid container spacing={2}>\n                <Grid item xs={12}>\n                  <Alert severity=\"info\">\n                    <AlertTitle>Microsoft Graph API Usage</AlertTitle>\n                    This component uses the Microsoft Graph API instead of the legacy SharePoint REST API, \n                    providing better performance, more capabilities, and improved security. \n                    Make sure your app registration has the appropriate permissions.\n                  </Alert>\n                </Grid>\n                \n                {/* Additional advanced options would go here */}\n              </Grid>\n            </Paper>\n          </Collapse>\n        </Box>\n        \n        {/* Browse Tab */}\n        <Box sx={{ display: activeTab === 1 ? 'block' : 'none', mt: 2 }}>\n          {hasValidCredentials ? (\n            <Box sx={{ height: 500 }}>\n              <SharePointBrowser\n                credentials={credentials}\n                onSelectSite={handleSiteSelect}\n                onSelectLibrary={handleLibrarySelect}\n                onSelectFolder={handleFolderSelect}\n                onSelectFile={handleFileSelect}\n                readOnly={readOnly}\n                selectedSite={selectedSite?.id || ''}\n                selectedLibrary={selectedLibrary?.id || ''}\n                selectedFolder={selectedFolder?.id || ''}\n              />\n            </Box>\n          ) : (\n            <Alert severity=\"warning\">\n              <AlertTitle>Credentials Required</AlertTitle>\n              Please configure valid SharePoint credentials in the Credentials tab before browsing.\n            </Alert>\n          )}\n        </Box>\n        \n        {/* Selection Tab */}\n        <Box sx={{ display: activeTab === 2 ? 'block' : 'none', mt: 2 }}>\n          <Paper variant=\"outlined\" sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>Selected Items</Typography>\n            \n            <Grid container spacing={2}>\n              {selectedSite && (\n                <Grid item xs={12}>\n                  <Paper variant=\"outlined\" sx={{ p: 2 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      <WebIcon color=\"primary\" sx={{ mr: 1 }} />\n                      <Typography variant=\"body1\" fontWeight=\"medium\">\n                        Site: {selectedSite.name}\n                      </Typography>\n                    </Box>\n                    {selectedSite.description && (\n                      <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                        {selectedSite.description}\n                      </Typography>\n                    )}\n                    <Typography variant=\"caption\" display=\"block\" sx={{ mt: 1 }}>\n                      URL: {selectedSite.webUrl || selectedSite.url}\n                    </Typography>\n                  </Paper>\n                </Grid>\n              )}\n              \n              {selectedLibrary && (\n                <Grid item xs={12}>\n                  <Paper variant=\"outlined\" sx={{ p: 2 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      <LibraryIcon color=\"primary\" sx={{ mr: 1 }} />\n                      <Typography variant=\"body1\" fontWeight=\"medium\">\n                        Library: {selectedLibrary.name}\n                      </Typography>\n                    </Box>\n                    {selectedLibrary.description && (\n                      <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                        {selectedLibrary.description}\n                      </Typography>\n                    )}\n                    <Typography variant=\"caption\" display=\"block\" sx={{ mt: 1 }}>\n                      Items: {selectedLibrary.itemCount || 0}\n                    </Typography>\n                  </Paper>\n                </Grid>\n              )}\n              \n              {selectedFolder && (\n                <Grid item xs={12}>\n                  <Paper variant=\"outlined\" sx={{ p: 2 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      <FolderIcon color=\"primary\" sx={{ mr: 1 }} />\n                      <Typography variant=\"body1\" fontWeight=\"medium\">\n                        Folder: {selectedFolder.name}\n                      </Typography>\n                    </Box>\n                    <Typography variant=\"caption\" display=\"block\" sx={{ mt: 1 }}>\n                      Path: {selectedFolder.webUrl}\n                    </Typography>\n                  </Paper>\n                </Grid>\n              )}\n              \n              {selectedFile && (\n                <Grid item xs={12}>\n                  <Paper variant=\"outlined\" sx={{ p: 2 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      <FileIcon color=\"primary\" sx={{ mr: 1 }} />\n                      <Typography variant=\"body1\" fontWeight=\"medium\">\n                        File: {selectedFile.name}\n                      </Typography>\n                    </Box>\n                    <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                      Type: {selectedFile.contentType || 'Unknown'}\n                    </Typography>\n                    <Typography variant=\"body2\" sx={{ mt: 0.5 }}>\n                      Size: {formatFileSize(selectedFile.size || 0)}\n                    </Typography>\n                    <Typography variant=\"caption\" display=\"block\" sx={{ mt: 1 }}>\n                      URL: {selectedFile.webUrl}\n                    </Typography>\n                  </Paper>\n                </Grid>\n              )}\n              \n              {!selectedSite && !selectedLibrary && !selectedFolder && !selectedFile && (\n                <Grid item xs={12}>\n                  <Alert severity=\"info\">\n                    No items selected. Please browse and select SharePoint items.\n                  </Alert>\n                </Grid>\n              )}\n            </Grid>\n          </Paper>\n          \n          <Box sx={{ mt: 2, display: 'flex', justifyContent: 'flex-end' }}>\n            <Button\n              variant=\"outlined\"\n              color=\"secondary\"\n              onClick={() => {\n                setSelectedSite(null);\n                setSelectedLibrary(null);\n                setSelectedFolder(null);\n                setSelectedFile(null);\n                \n                onChange({\n                  ...value,\n                  credentials,\n                  site: null,\n                  library: null,\n                  folder: null,\n                  file: null,\n                });\n              }}\n              sx={{ mr: 1 }}\n            >\n              Clear Selection\n            </Button>\n            \n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              startIcon={<CloudDoneIcon />}\n              disabled={!hasValidCredentials || (!hasFileSelected && !hasFolderSelected && !hasLibrarySelected && !hasSiteSelected)}\n              onClick={() => {\n                // In a real application, this might save the configuration or proceed to the next step\n                console.log('SharePoint configuration completed:', {\n                  credentials,\n                  site: selectedSite,\n                  library: selectedLibrary,\n                  folder: selectedFolder,\n                  file: selectedFile,\n                });\n              }}\n            >\n              Confirm Selection\n            </Button>\n          </Box>\n        </Box>\n      </CardContent>\n    </Card>\n  );\n};\n\n/**\n * Format file size to human-readable format\n * @param {number} bytes - File size in bytes\n * @returns {string} Formatted size\n */\nconst formatFileSize = (bytes) => {\n  if (bytes === 0) return '0 Bytes';\n  \n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  \n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n};\n\nSharePointConfiguration.propTypes = {\n  /**\n   * The configuration value\n   */\n  value: PropTypes.shape({\n    credentials: PropTypes.object,\n    site: PropTypes.object,\n    library: PropTypes.object,\n    folder: PropTypes.object,\n    file: PropTypes.object,\n  }),\n  \n  /**\n   * Callback when configuration changes\n   */\n  onChange: PropTypes.func,\n  \n  /**\n   * Whether the component is in read-only mode\n   */\n  readOnly: PropTypes.bool,\n};\n\nexport default SharePointConfiguration;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}